# WSL-specific environment variables

# WSL version detection
if [[ -f /proc/sys/fs/binfmt_misc/WSLInterop ]]; then
  export WSL_VERSION=2
else
  export WSL_VERSION=1
fi

# Enable WSLg display server (WSL2 with GUI support)
if [[ $WSL_VERSION -eq 2 ]]; then
  # WSLg sets this automatically, but ensure it's set
  export DISPLAY="${DISPLAY:-:0}"
  export WAYLAND_DISPLAY="${WAYLAND_DISPLAY:-wayland-0}"
  export XDG_RUNTIME_DIR="${XDG_RUNTIME_DIR:-/run/user/$(id -u)}"
  export PULSE_SERVER="${PULSE_SERVER:-unix:/mnt/wslg/PulseServer}"
fi

# Windows user directory
export WINHOME="/mnt/c/Users/$USER"

# Add Windows executables to PATH
export PATH="$PATH:/mnt/c/Windows/System32"
export PATH="$PATH:/mnt/c/Windows/System32/WindowsPowerShell/v1.0"

# Browser for WSL (use Windows browser)
export BROWSER="/mnt/c/Program Files/Google/Chrome/Application/chrome.exe"

# Fix for "bad interpreter" errors with Windows line endings
export SHELLOPTS
set -o igncr

# Docker host (if using Docker Desktop for Windows)
if [[ -S /var/run/docker.sock ]]; then
  export DOCKER_HOST="unix:///var/run/docker.sock"
fi

# Windows-style temp directory
export WINTMP="/mnt/c/Windows/Temp"
